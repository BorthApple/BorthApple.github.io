<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    Bing词典查单词第三方API |
    
    小天才</title>
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  
    <link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">
  
  <script src="/js/pace.min.js"></script>
</head>

<body>
<main class="content">
  <section class="outer">
  

<article id="post-Bing词典查单词第三方API" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Bing词典查单词第三方API
    </h1>
  
  




      </header>
    

    
      <div class="article-meta">
        <a href="/posts/57344/" class="article-date">
  <time datetime="2018-03-09T17:01:48.000Z" itemprop="datePublished">2018-03-10</time>
</a>
        
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/">计算机</a>
  </div>

      </div>
    

    
      
    <div class="tocbot"></div>





    

    <div class="article-entry" itemprop="articleBody">
      


      

      
        <p>利用简单的请求，获得详细的中英释义及例句</p>
<p>因为自己建立了一个电子生词本，经常需要在Excel表格中使用到查单词的功能。为了方便，开发了这样的一个简单的API。</p>
<p>本文即介绍这个API的调用方式以及在Excel中如何具体调用。</p>
<a id="more"></a>

<h2 id="API调用方式（若没有技术背景可直接看后文在Excel中直接使用）"><a href="#API调用方式（若没有技术背景可直接看后文在Excel中直接使用）" class="headerlink" title="API调用方式（若没有技术背景可直接看后文在Excel中直接使用）"></a>API调用方式（若没有技术背景可直接看后文在Excel中直接使用）</h2><p>为便于调用，API采用了非常简便的Get方式调用。只需要一个参数<code>word</code>即可。</p>
<p>如下是一个请求示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.fenzhengrou.wang&#x2F;engtools&#x2F;dic?word&#x3D;hello</span></pre></td></tr></table></figure>

<p>返回的数据也非常简单，是一个Json字串：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">&#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"headword"</span>: <span class="string">"hello"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"meanings"</span>: &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"int."</span>: <span class="string">"你好；喂；您好；哈喽"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"网络"</span>: <span class="string">"哈罗；哈啰；大家好"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"pronunce"</span>: [<span class="string">"美[heˈləʊ] "</span>, <span class="string">"英[həˈləʊ] "</span>],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"sample"</span>: &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"H is for hello , whichis something nice to say , it means I 'm glad to see you , any time of a day ."</span>: <span class="string">"H代表你好，一句彬彬有礼的问好，意思是我在一天的任何时候都很高兴见到你。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"He saidto say hello and he hopes we 'll seeyoufor dinner soon , but he 's got too much work togo out pub crawlingwith the boys ."</span>: <span class="string">"他说让我问好，还说希望我们三个最近能在一起吃顿午饭，但是他要干的活儿实在太多了，所以没时间和咱们在酒吧里鬼混了。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"Hello ! How much should I pay ?"</span>: <span class="string">"你好！我要交多少钱？"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"Hello , Sergio . What'sthematter ? - - I 'm feeling terrible . --Oh , dear ! Why don't you see adoctor ? -- Perhaps I will ."</span>: <span class="string">"你好，塞吉尔。你怎麽了？--我感觉很难受。--哎呀！你怎麽不去看医生？--也许我就去。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"It was OK . Thank you for coming out to meet me eventhough you are busy . Oh yeah , Andyasked me tosay hello ."</span>: <span class="string">"没关系。你很忙还来接我真是谢谢。对了，还有安迪向你问好。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"Or if oneof our cats comes uptosay hello , rubs itself on my leg and settles down for a nap near me . . . yep : great day!"</span>: <span class="string">"再或者，如果我们的某只猫走过来跟我打招呼，再拿身子在我腿上蹭，然后靠近我躺下来打个盹儿…没错：奇妙无比的又一天！"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"Thankful fora familiar face in the crowd I mademywaytoward her to say hello ."</span>: <span class="string">"感谢能在人群里见到熟悉的脸庞，我走过去，跟她打招呼。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"The thing that annoys me about him is theway he never says\" Hello !\" ."</span>: <span class="string">"他使我讨厌的是，从来不跟别人打呼。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"Though I was a bit underdressed in apair of khaki pants and a damp leather jacket I decided to step in and say hello to her ."</span>: <span class="string">"虽然我当时穿着有些寒酸——黄褐色的裤子和潮湿的皮夹克，但我还是决定要走进去和她打个招呼。"</span>,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"When she greetedmewithher hello , I replied \" Guess what I need from you today ? \""</span>: <span class="string">"她向我打招呼，我说：你说我想弄点什么呢？"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line">&#125;,</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"tabs"</span>: &#123;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"反义词"</span>: [<span class="string">"int."</span>, <span class="string">"ciao"</span>, <span class="string">","</span>, <span class="string">"good afternoon"</span>, <span class="string">","</span>, <span class="string">"good day"</span>, <span class="string">","</span>, <span class="string">"good morning"</span>, <span class="string">","</span>, <span class="string">"hi"</span>],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"同义词"</span>: [<span class="string">"int."</span>, <span class="string">"goodbye"</span>],</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="attr">"搭配"</span>: [<span class="string">"v.+n."</span>, <span class="string">"say Hello"</span>]</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">&#125;</span></pre></td></tr></table></figure>

<p>剩下的，就是直接解析出来使用了。</p>
<h2 id="在Excel中使用"><a href="#在Excel中使用" class="headerlink" title="在Excel中使用"></a>在Excel中使用</h2><p>在2013版本之后，Excel中加入了<code>WEBSERVICE</code>函数。若不想使用这里提到的自定义函数，可以直接使用WEBSERVICE函数。</p>
<p>最终效果如下：</p>
<p><img src="https://i.loli.net/2018/02/20/5a8bf47280c01.png" alt></p>
<h3 id="1-文档设置"><a href="#1-文档设置" class="headerlink" title="1.文档设置"></a>1.文档设置</h3><p>首先我们需要把我们的Excel文档另存为xlsm格式，因为这样的格式可以加入自定义的函数。具体可以直接在另存为中选择<code>Excel启用宏的工作簿 *.xlsm</code></p>
<p>然后，我们在<code>文件-&amp;gt;选项-&amp;gt;自定义功能区</code>的中找到<strong>开发工具</strong>并勾选。最终效果如图所示：</p>
<p><img src="https://i.loli.net/2018/02/20/5a8bf59f91908.png" alt></p>
<h3 id="2-启用正则表达式"><a href="#2-启用正则表达式" class="headerlink" title="2.启用正则表达式"></a>2.启用正则表达式</h3><p>我们点击<code>查看代码</code></p>
<p><img src="https://i.loli.net/2018/02/20/5a8bf64c6441e.png" alt></p>
<p>在弹出的界面中选择<code>菜单-&amp;gt;工具-&amp;gt;引用</code>并勾选<code>Microsoft VBScript Regular Expressions 5.5</code>(若没有该选项，可以尝试勾选其他的最新版，切记勿勾选多个版本）然后单击<code>确定</code></p>
<h3 id="3-建立自定义函数"><a href="#3-建立自定义函数" class="headerlink" title="3.建立自定义函数"></a>3.建立自定义函数</h3><p>看到窗口的左面，有类似的如下界面（可能有些许不同，但不影响使用）</p>
<p><img src="https://i.loli.net/2018/02/20/5a8bf760d15f6.png" alt></p>
<p>在<code>Microsoft Excel对象</code>处单击右键选择<code>插入-&amp;gt;模块</code>，双击创建出来的该模块，并在代码框中复制上以下内容：</p>
<figure class="highlight vb"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">2</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> LookupWord(word)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">3</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">If</span> Len(word) &lt; <span class="number">1</span> <span class="keyword">Then</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">4</span></pre></td><td class="code"><pre><span class="line">LookupWord = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">5</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Exit</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">6</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">7</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">8</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">With</span> CreateObject(<span class="string">"Microsoft.XMLHTTP"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">9</span></pre></td><td class="code"><pre><span class="line">.Open <span class="string">"GET"</span>, <span class="string">"https://www.fenzhengrou.wang/engtools/dic?word="</span> &amp; word, <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">10</span></pre></td><td class="code"><pre><span class="line">.Send</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">11</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Do</span> <span class="keyword">Until</span> .ReadyState = <span class="number">4</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">12</span></pre></td><td class="code"><pre><span class="line">DoEvents</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">13</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Loop</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">14</span></pre></td><td class="code"><pre><span class="line">LookupWord = .responsetext</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">15</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">16</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">17</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">18</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> regular_find(str, pat)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">19</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> mRegExp <span class="keyword">As</span> RegExp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">20</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> mMatches <span class="keyword">As</span> MatchCollection <span class="comment">'匹配字符串集合对象</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">21</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> mMatch <span class="keyword">As</span> Match <span class="comment">'匹配字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">22</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">23</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> mRegExp = <span class="keyword">New</span> RegExp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">24</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">With</span> mRegExp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">25</span></pre></td><td class="code"><pre><span class="line">.<span class="keyword">Global</span> = <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">26</span></pre></td><td class="code"><pre><span class="line">.IgnoreCase = <span class="literal">False</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">27</span></pre></td><td class="code"><pre><span class="line">.Pattern = pat</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">28</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> mMatches = .Execute(str)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">29</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">30</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">31</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">32</span></pre></td><td class="code"><pre><span class="line">ret = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">33</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">34</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> mMatch <span class="keyword">In</span> mMatches</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">35</span></pre></td><td class="code"><pre><span class="line">ret = ret &amp; mMatch.Value</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">36</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Next</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">37</span></pre></td><td class="code"><pre><span class="line">regular_find = ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">38</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">39</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">40</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> regular_find_all(str, pat)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">41</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> mRegExp <span class="keyword">As</span> RegExp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">42</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> mMatches <span class="keyword">As</span> MatchCollection <span class="comment">'匹配字符串集合对象</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">43</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> mMatch <span class="keyword">As</span> Match <span class="comment">'匹配字符串</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">44</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">45</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> mRegExp = <span class="keyword">New</span> RegExp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">46</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">With</span> mRegExp</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">47</span></pre></td><td class="code"><pre><span class="line">.<span class="keyword">Global</span> = <span class="literal">True</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">48</span></pre></td><td class="code"><pre><span class="line">.IgnoreCase = <span class="literal">False</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">49</span></pre></td><td class="code"><pre><span class="line">.Pattern = pat</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">50</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> mMatches = .Execute(str)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">51</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">With</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">52</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">53</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">54</span></pre></td><td class="code"><pre><span class="line">ret = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">55</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">56</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> mMatch <span class="keyword">In</span> mMatches</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">57</span></pre></td><td class="code"><pre><span class="line">ret = ret &amp; <span class="string">"||||"</span> &amp; mMatch.Value</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">58</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Next</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">59</span></pre></td><td class="code"><pre><span class="line">regular_find_all = Split(ret, <span class="string">"||||"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">60</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">61</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">62</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetPronunciation(ori_data)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">63</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> pronunce_part</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">64</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> pronunce</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">65</span></pre></td><td class="code"><pre><span class="line">pronunce_part = regular_find(ori_data, <span class="string">"(pronunce[\s\S]*?\],)"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">66</span></pre></td><td class="code"><pre><span class="line">pronunce = regular_find(pronunce_part, <span class="string">"(\[""[\s\S]*?""\])"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">67</span></pre></td><td class="code"><pre><span class="line">pronunce = Replace(pronunce, <span class="string">"["""</span>, <span class="string">""</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">68</span></pre></td><td class="code"><pre><span class="line">pronunce = Replace(pronunce, <span class="string">"""]"</span>, <span class="string">""</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">69</span></pre></td><td class="code"><pre><span class="line">pronunce = Replace(pronunce, <span class="string">""""</span>, <span class="string">""</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">70</span></pre></td><td class="code"><pre><span class="line">pronunce = Replace(pronunce, <span class="string">" ,"</span>, Chr(<span class="number">10</span>))</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">71</span></pre></td><td class="code"><pre><span class="line">GetPronunciation = pronunce</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">72</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">73</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">74</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetMeanings(ori_data)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">75</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> meanings_part</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">76</span></pre></td><td class="code"><pre><span class="line">meanings_part = regular_find(ori_data, <span class="string">"(meanings"":\&#123;[\s\S]*?\&#125;)"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">77</span></pre></td><td class="code"><pre><span class="line">meanings_part = regular_find(meanings_part, <span class="string">"(\&#123;[\s\S]*?\&#125;)"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">78</span></pre></td><td class="code"><pre><span class="line">meanings = regular_find_all(meanings_part, <span class="string">"(""[\s\S]*?"")"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">79</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">80</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">81</span></pre></td><td class="code"><pre><span class="line">ret = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">82</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> UBound(meanings) <span class="keyword">Step</span> <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">83</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">If</span> ((i - <span class="number">1</span>) <span class="keyword">Mod</span> <span class="number">2</span>) = <span class="number">0</span> <span class="keyword">And</span> (i - <span class="number">1</span>) &lt;&gt; <span class="number">0</span> <span class="keyword">Then</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">84</span></pre></td><td class="code"><pre><span class="line">ret = ret &amp; Chr(<span class="number">10</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">85</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">86</span></pre></td><td class="code"><pre><span class="line">ret = ret &amp; <span class="keyword">Mid</span>(meanings(i), <span class="number">2</span>, Len(meanings(i)) - <span class="number">2</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">87</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">If</span> ((i - <span class="number">1</span>) <span class="keyword">Mod</span> <span class="number">2</span>) = <span class="number">0</span> <span class="keyword">Then</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">88</span></pre></td><td class="code"><pre><span class="line">ret = ret &amp; <span class="string">":"</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">89</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">90</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Next</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">91</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">92</span></pre></td><td class="code"><pre><span class="line">GetMeanings = ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">93</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">94</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">95</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">96</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetSamples(ori_data, max_sample)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">97</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Dim</span> samples_part</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">98</span></pre></td><td class="code"><pre><span class="line">samples_part = regular_find(ori_data, <span class="string">"(sample"":\&#123;[\s\S]*?\&#125;)"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">99</span></pre></td><td class="code"><pre><span class="line">samples_part = regular_find(samples_part, <span class="string">"(\&#123;[\s\S]*?\&#125;)"</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">100</span></pre></td><td class="code"><pre><span class="line">samples_part = <span class="keyword">Mid</span>(samples_part, <span class="number">3</span>, Len(samples_part) - <span class="number">2</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">101</span></pre></td><td class="code"><pre><span class="line">samples_part_arr = Split(samples_part, <span class="string">""","""</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">102</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">If</span> UBound(samples_part_arr) + <span class="number">1</span> &lt; max_sample <span class="keyword">Then</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">103</span></pre></td><td class="code"><pre><span class="line">max_sample = UBound(samples_part_arr) + <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">104</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">105</span></pre></td><td class="code"><pre><span class="line">ret = <span class="string">""</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">106</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">For</span> i = <span class="number">0</span> <span class="keyword">To</span> max_sample - <span class="number">1</span> <span class="keyword">Step</span> <span class="number">1</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">107</span></pre></td><td class="code"><pre><span class="line">samples_zip = Split(samples_part_arr(i), <span class="string">""":"""</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">108</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">If</span> UBound(samples_zip) = <span class="number">1</span> <span class="keyword">Then</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">109</span></pre></td><td class="code"><pre><span class="line">ret = ret &amp; (i + <span class="number">1</span>) &amp; <span class="string">". "</span> &amp; samples_zip(<span class="number">0</span>) &amp; Chr(<span class="number">10</span>) &amp; samples_zip(<span class="number">1</span>) &amp; Chr(<span class="number">10</span>)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">110</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">111</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Next</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">112</span></pre></td><td class="code"><pre><span class="line">GetSamples = ret</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">113</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">114</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">115</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">Function</span> GetSyn(ori_data)</span></pre></td></tr><tr><td class="gutter"><pre><span class="line">116</span></pre></td><td class="code"><pre><span class="line"></span></pre></td></tr><tr><td class="gutter"><pre><span class="line">117</span></pre></td><td class="code"><pre><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span></pre></td></tr></table></figure>
<p>保存，然后回到Excel的主窗口。</p>
<h3 id="4-使用自定义函数"><a href="#4-使用自定义函数" class="headerlink" title="4.使用自定义函数"></a>4.使用自定义函数</h3><p>现在，我们就可以使用刚刚设置好的函数了。<br>例如如下是获得一个单词的释义到当前单元格。这里的A1是存放单词的单元格。</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">=GetMeanings(LookupWord(<span class="symbol">A1</span>))</span></pre></td></tr></table></figure>
<p>例如如下是获得一个单词的例句到当前单元格。这里的A1是存放单词的单元格，2为获得例句的最大数量。</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">=GetSamples(LookupWord(<span class="symbol">A1</span>),<span class="number">2</span>)</span></pre></td></tr></table></figure>
<p>例如如下是获得一个单词的读音到当前单元格。这里的A1是存放单词的单元格。</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span></pre></td><td class="code"><pre><span class="line">=GetPronunciation(LookupWord(<span class="symbol">A1</span>))</span></pre></td></tr></table></figure>
<p>当前，在设置好以后，单元格默认是不会自动换行的，我们需要将其设置为自动换行，才能获得更好的显示效果</p>
<p><img src="https://i.loli.net/2018/02/20/5a8bfafdbf861.png" alt></p>
<p>如此，便大功告成。只需要使用如上示例中的三个函数，就能获得单词的发音、释义、例句信息。</p>
<h3 id="5-特别注意"><a href="#5-特别注意" class="headerlink" title="5.特别注意"></a>5.特别注意</h3><p>如果在打开Excel后，出现了如下提示，请务必选择<code>启用内容</code>。否则函数将无法计算。</p>
<p><img src="https://i.loli.net/2018/02/20/5a8bfb5415b8a.png" alt></p>
<p><strong>由于Excel会在每次打开的时候尝试重新计算函数结果，所以建议在获得完释义以后将函数运行的结果单独复制成文本，而非保留公式。</strong></p>
<h2 id="其他调用方式"><a href="#其他调用方式" class="headerlink" title="其他调用方式"></a>其他调用方式</h2><p>如果希望使用其他的程序，例如通过编写程序来实现调用。只需要参考第一节来使用Get请求获得结果即可。</p>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>本API的数据均来自微软Bing词典，仅限于个人非商业性质地使用，若用户将该API用于不正当用途产生侵权或其他法律纠纷，与笔者无关。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fenzhengrou.wang/posts/57344/" data-id="ckhrk29yf0002dyvlf70v8vxk"
         class="article-share-link">分享</a>
      
    </footer>

  </div>

  
    
  <nav class="article-nav">
    
      <a href="/posts/13167/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">
          
            店大不能欺客，被中移动劫持插入广告维权实录
          
        </div>
      </a>
    
    
      <a href="/posts/8383/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">初窥比特币，革命性的时代骄傲</div>
      </a>
    
  </nav>


  

  
    
  

</article>



</section>
  <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
    <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>&copy; 2020 小天才</li>
      <!-- <li>湘ICP备18010341号-1</li> -->
    </ul>
  </div>
</footer>

</main>

<aside class="sidebar sidebar-specter">
  
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
    <div class="logo">
      <a href="/"><img src="/images/hexo.svg" alt="小天才"></a>
    </div>
  
  <ul class="nav nav-main">
    
      <li class="nav-item">
        <a class="nav-item-link" href="/">首页</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/archives">文字</a>
      </li>
    
      <li class="nav-item">
        <a class="nav-item-link" href="/about">关于</a>
      </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="搜索">
        <i class="fe fe-search"></i>
        搜索
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
        <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
          <i class="fe fe-feed"></i>
        </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/lazyload.min.js"></script>
<script src="/js/busuanzi-2.3.pure.min.js"></script>

  <script src="/fancybox/jquery.fancybox.min.js"></script>



  <script src="/js/tocbot.min.js"></script>
  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
    });
  </script>


<script src="/js/ocean.js"></script>

</body>
</html>